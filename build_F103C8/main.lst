ARM GAS  C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s 			page 1


   1              		.cpu cortex-m3
   2              		.arch armv7-m
   3              		.fpu softvfp
   4              		.eabi_attribute 20, 1
   5              		.eabi_attribute 21, 1
   6              		.eabi_attribute 23, 3
   7              		.eabi_attribute 24, 1
   8              		.eabi_attribute 25, 1
   9              		.eabi_attribute 26, 1
  10              		.eabi_attribute 30, 1
  11              		.eabi_attribute 34, 1
  12              		.eabi_attribute 18, 4
  13              		.file	"main.c"
  14              		.text
  15              	.Ltext0:
  16              		.cfi_sections	.debug_frame
  17              		.file 1 "Core/Src/main.c"
  18              		.section	.text.delay,"ax",%progbits
  19              		.align	1
  20              		.global	delay
  21              		.syntax unified
  22              		.thumb
  23              		.thumb_func
  25              	delay:
  26              	.LVL0:
  27              	.LFB0:
   1:Core/Src/main.c **** #include <stdint.h>
   2:Core/Src/main.c **** 
   3:Core/Src/main.c **** #define GPIOA_BASE          0x40010800U
   4:Core/Src/main.c **** #define GPIOC_BASE          0x40011000U
   5:Core/Src/main.c **** #define RCC_BASE            0x40021000U
   6:Core/Src/main.c **** 
   7:Core/Src/main.c **** #define GPIOA               ((GPIO_TypeDef *) GPIOA_BASE)
   8:Core/Src/main.c **** #define GPIOC               ((GPIO_TypeDef *) GPIOC_BASE)
   9:Core/Src/main.c **** #define RCC                 ((RCC_TypeDef *) RCC_BASE)
  10:Core/Src/main.c **** 
  11:Core/Src/main.c **** typedef struct {
  12:Core/Src/main.c ****     volatile uint32_t CRL;
  13:Core/Src/main.c ****     volatile uint32_t CRH;
  14:Core/Src/main.c ****     volatile uint32_t IDR;
  15:Core/Src/main.c ****     volatile uint32_t ODR;
  16:Core/Src/main.c ****     volatile uint32_t BSRR;
  17:Core/Src/main.c ****     volatile uint32_t BRR;
  18:Core/Src/main.c ****     volatile uint32_t LCKR;
  19:Core/Src/main.c **** } GPIO_TypeDef;
  20:Core/Src/main.c **** 
  21:Core/Src/main.c **** typedef struct {
  22:Core/Src/main.c ****     volatile uint32_t CR;
  23:Core/Src/main.c ****     volatile uint32_t CFGR;
  24:Core/Src/main.c ****     volatile uint32_t CIR;
  25:Core/Src/main.c ****     volatile uint32_t APB2RSTR;
  26:Core/Src/main.c ****     volatile uint32_t APB1RSTR;
  27:Core/Src/main.c ****     volatile uint32_t AHBENR;
  28:Core/Src/main.c ****     volatile uint32_t APB2ENR;
  29:Core/Src/main.c ****     volatile uint32_t APB1ENR;
  30:Core/Src/main.c ****     volatile uint32_t BDCR;
  31:Core/Src/main.c ****     volatile uint32_t CSR;
ARM GAS  C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s 			page 2


  32:Core/Src/main.c **** } RCC_TypeDef;
  33:Core/Src/main.c **** 
  34:Core/Src/main.c **** void delay(uint32_t count) {
  28              		.loc 1 34 28 view -0
  29              		.cfi_startproc
  30              		@ args = 0, pretend = 0, frame = 8
  31              		@ frame_needed = 0, uses_anonymous_args = 0
  32              		@ link register save eliminated.
  33              		.loc 1 34 28 is_stmt 0 view .LVU1
  34 0000 82B0     		sub	sp, sp, #8
  35              	.LCFI0:
  36              		.cfi_def_cfa_offset 8
  35:Core/Src/main.c ****     for(volatile uint32_t i = 0; i < count; i++);
  37              		.loc 1 35 5 is_stmt 1 view .LVU2
  38              	.LBB2:
  39              		.loc 1 35 9 view .LVU3
  40              		.loc 1 35 27 is_stmt 0 view .LVU4
  41 0002 0023     		movs	r3, #0
  42 0004 0193     		str	r3, [sp, #4]
  43              		.loc 1 35 5 view .LVU5
  44 0006 02E0     		b	.L2
  45              	.L3:
  46              		.loc 1 35 46 is_stmt 1 discriminator 3 view .LVU6
  47 0008 019B     		ldr	r3, [sp, #4]
  48 000a 0133     		adds	r3, r3, #1
  49 000c 0193     		str	r3, [sp, #4]
  50              	.L2:
  51              		.loc 1 35 36 discriminator 1 view .LVU7
  52 000e 019B     		ldr	r3, [sp, #4]
  53 0010 8342     		cmp	r3, r0
  54 0012 F9D3     		bcc	.L3
  55              	.LBE2:
  36:Core/Src/main.c **** }
  56              		.loc 1 36 1 is_stmt 0 view .LVU8
  57 0014 02B0     		add	sp, sp, #8
  58              	.LCFI1:
  59              		.cfi_def_cfa_offset 0
  60              		@ sp needed
  61 0016 7047     		bx	lr
  62              		.cfi_endproc
  63              	.LFE0:
  65              		.section	.text.main,"ax",%progbits
  66              		.align	1
  67              		.global	main
  68              		.syntax unified
  69              		.thumb
  70              		.thumb_func
  72              	main:
  73              	.LFB1:
  37:Core/Src/main.c **** 
  38:Core/Src/main.c **** int main(void) {
  74              		.loc 1 38 16 is_stmt 1 view -0
  75              		.cfi_startproc
  76              		@ args = 0, pretend = 0, frame = 0
  77              		@ frame_needed = 0, uses_anonymous_args = 0
  78 0000 70B5     		push	{r4, r5, r6, lr}
  79              	.LCFI2:
ARM GAS  C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s 			page 3


  80              		.cfi_def_cfa_offset 16
  81              		.cfi_offset 4, -16
  82              		.cfi_offset 5, -12
  83              		.cfi_offset 6, -8
  84              		.cfi_offset 14, -4
  39:Core/Src/main.c ****     // ИНИЦИАЛИЗАЦИЯ
  40:Core/Src/main.c ****     RCC->APB2ENR |= (1 << 2) | (1 << 4); // Включаем тактирование GPIOA и GPIO
  85              		.loc 1 40 5 view .LVU10
  86              		.loc 1 40 8 is_stmt 0 view .LVU11
  87 0002 314A     		ldr	r2, .L19
  88 0004 9369     		ldr	r3, [r2, #24]
  89              		.loc 1 40 18 view .LVU12
  90 0006 43F01403 		orr	r3, r3, #20
  91 000a 9361     		str	r3, [r2, #24]
  41:Core/Src/main.c ****     GPIOA->CRL = 0x11110000; // PA4-PA7 как выходы
  92              		.loc 1 41 5 is_stmt 1 view .LVU13
  93              		.loc 1 41 16 is_stmt 0 view .LVU14
  94 000c 2F4B     		ldr	r3, .L19+4
  95 000e 304A     		ldr	r2, .L19+8
  96 0010 1A60     		str	r2, [r3]
  42:Core/Src/main.c ****     GPIOC->CRH = 0x44344444; // PC13 как вход с подтяжкой
  97              		.loc 1 42 5 is_stmt 1 view .LVU15
  98              		.loc 1 42 16 is_stmt 0 view .LVU16
  99 0012 03F50063 		add	r3, r3, #2048
 100 0016 2F4A     		ldr	r2, .L19+12
 101 0018 5A60     		str	r2, [r3, #4]
  43:Core/Src/main.c ****     
  44:Core/Src/main.c ****     // Подтяжка к питанию для PC13
  45:Core/Src/main.c ****     GPIOC->ODR |= (1 << 13);
 102              		.loc 1 45 5 is_stmt 1 view .LVU17
 103              		.loc 1 45 10 is_stmt 0 view .LVU18
 104 001a DA68     		ldr	r2, [r3, #12]
 105              		.loc 1 45 16 view .LVU19
 106 001c 42F40052 		orr	r2, r2, #8192
 107 0020 DA60     		str	r2, [r3, #12]
  46:Core/Src/main.c ****     
  47:Core/Src/main.c ****     // ТЕСТ: 3 мигания
  48:Core/Src/main.c ****     for(int i = 0; i < 3; i++) {
 108              		.loc 1 48 5 is_stmt 1 view .LVU20
 109              	.LBB3:
 110              		.loc 1 48 9 view .LVU21
 111              	.LVL1:
 112              		.loc 1 48 13 is_stmt 0 view .LVU22
 113 0022 0024     		movs	r4, #0
 114              		.loc 1 48 5 view .LVU23
 115 0024 0DE0     		b	.L6
 116              	.LVL2:
 117              	.L7:
  49:Core/Src/main.c ****         GPIOA->BSRR = (1 << 4) | (1 << 5) | (1 << 6) | (1 << 7);
 118              		.loc 1 49 9 is_stmt 1 view .LVU24
 119              		.loc 1 49 21 is_stmt 0 view .LVU25
 120 0026 294E     		ldr	r6, .L19+4
 121 0028 F023     		movs	r3, #240
 122 002a 3361     		str	r3, [r6, #16]
  50:Core/Src/main.c ****         delay(500000);
 123              		.loc 1 50 9 is_stmt 1 view .LVU26
 124 002c 2A4D     		ldr	r5, .L19+16
ARM GAS  C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s 			page 4


 125 002e 2846     		mov	r0, r5
 126 0030 FFF7FEFF 		bl	delay
 127              	.LVL3:
  51:Core/Src/main.c ****         GPIOA->BSRR = (1 << (4+16)) | (1 << (5+16)) | (1 << (6+16)) | (1 << (7+16));
 128              		.loc 1 51 9 view .LVU27
 129              		.loc 1 51 21 is_stmt 0 view .LVU28
 130 0034 4FF47003 		mov	r3, #15728640
 131 0038 3361     		str	r3, [r6, #16]
  52:Core/Src/main.c ****         delay(500000);
 132              		.loc 1 52 9 is_stmt 1 view .LVU29
 133 003a 2846     		mov	r0, r5
 134 003c FFF7FEFF 		bl	delay
 135              	.LVL4:
  48:Core/Src/main.c ****         GPIOA->BSRR = (1 << 4) | (1 << 5) | (1 << 6) | (1 << 7);
 136              		.loc 1 48 28 discriminator 3 view .LVU30
 137 0040 0134     		adds	r4, r4, #1
 138              	.LVL5:
 139              	.L6:
  48:Core/Src/main.c ****         GPIOA->BSRR = (1 << 4) | (1 << 5) | (1 << 6) | (1 << 7);
 140              		.loc 1 48 22 discriminator 1 view .LVU31
 141 0042 022C     		cmp	r4, #2
 142 0044 EFDD     		ble	.L7
 143              	.LBE3:
  53:Core/Src/main.c ****     }
  54:Core/Src/main.c ****     
  55:Core/Src/main.c ****     uint8_t current_step = 0;
 144              		.loc 1 55 5 view .LVU32
 145              	.LVL6:
  56:Core/Src/main.c ****     uint8_t last_btn = 1;
 146              		.loc 1 56 5 view .LVU33
  57:Core/Src/main.c ****     
  58:Core/Src/main.c ****     GPIOA->BSRR = (1 << (4+16)) | (1 << (5+16)) | (1 << (6+16)) | (1 << (7+16));
 147              		.loc 1 58 5 view .LVU34
 148              		.loc 1 58 17 is_stmt 0 view .LVU35
 149 0046 214B     		ldr	r3, .L19+4
 150 0048 4FF47002 		mov	r2, #15728640
 151 004c 1A61     		str	r2, [r3, #16]
  56:Core/Src/main.c ****     uint8_t last_btn = 1;
 152              		.loc 1 56 13 view .LVU36
 153 004e 0122     		movs	r2, #1
  55:Core/Src/main.c ****     uint8_t last_btn = 1;
 154              		.loc 1 55 13 view .LVU37
 155 0050 0024     		movs	r4, #0
 156              	.LVL7:
  55:Core/Src/main.c ****     uint8_t last_btn = 1;
 157              		.loc 1 55 13 view .LVU38
 158 0052 15E0     		b	.L16
 159              	.LVL8:
 160              	.L9:
 161              	.LBB4:
  59:Core/Src/main.c ****     
  60:Core/Src/main.c ****     while(1) {
  61:Core/Src/main.c ****         // Чтение PC13 вместо PA2
  62:Core/Src/main.c ****         uint8_t btn = !(GPIOC->IDR & (1 << 13));
  63:Core/Src/main.c ****         
  64:Core/Src/main.c ****         if (btn && !last_btn) {
  65:Core/Src/main.c ****             current_step++;
ARM GAS  C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s 			page 5


  66:Core/Src/main.c ****             if (current_step > 4) current_step = 0;
  67:Core/Src/main.c ****             
  68:Core/Src/main.c ****             GPIOA->BSRR = (1 << (4+16)) | (1 << (5+16)) | (1 << (6+16)) | (1 << (7+16));
 162              		.loc 1 68 13 is_stmt 1 view .LVU39
 163              		.loc 1 68 25 is_stmt 0 view .LVU40
 164 0054 1D4B     		ldr	r3, .L19+4
 165 0056 4FF47002 		mov	r2, #15728640
 166              	.LVL9:
 167              		.loc 1 68 25 view .LVU41
 168 005a 1A61     		str	r2, [r3, #16]
  69:Core/Src/main.c ****             
  70:Core/Src/main.c ****             switch(current_step) {
 169              		.loc 1 70 13 is_stmt 1 view .LVU42
 170 005c 631E     		subs	r3, r4, #1
 171 005e 032B     		cmp	r3, #3
 172 0060 06D8     		bhi	.L10
 173 0062 DFE803F0 		tbb	[pc, r3]
 174              	.L12:
 175 0066 02       		.byte	(.L15-.L12)/2
 176 0067 25       		.byte	(.L14-.L12)/2
 177 0068 29       		.byte	(.L13-.L12)/2
 178 0069 2D       		.byte	(.L11-.L12)/2
 179              		.p2align 1
 180              	.L15:
  71:Core/Src/main.c ****                 case 1: GPIOA->BSRR = (1 << 4); break;
 181              		.loc 1 71 25 view .LVU43
 182              		.loc 1 71 37 is_stmt 0 view .LVU44
 183 006a 184B     		ldr	r3, .L19+4
 184 006c 1022     		movs	r2, #16
 185 006e 1A61     		str	r2, [r3, #16]
 186              		.loc 1 71 49 is_stmt 1 view .LVU45
 187              	.LVL10:
 188              	.L10:
  72:Core/Src/main.c ****                 case 2: GPIOA->BSRR = (1 << 4) | (1 << 5); break;
  73:Core/Src/main.c ****                 case 3: GPIOA->BSRR = (1 << 4) | (1 << 5) | (1 << 6); break;
  74:Core/Src/main.c ****                 case 4: GPIOA->BSRR = (1 << 4) | (1 << 5) | (1 << 6) | (1 << 7); break;
  75:Core/Src/main.c ****                 case 0: break;
  76:Core/Src/main.c ****             }
  77:Core/Src/main.c ****             
  78:Core/Src/main.c ****             delay(100000);
 189              		.loc 1 78 13 view .LVU46
 190 0070 1A48     		ldr	r0, .L19+20
 191 0072 FFF7FEFF 		bl	delay
 192              	.LVL11:
 193              	.L8:
  79:Core/Src/main.c ****         }
  80:Core/Src/main.c ****         
  81:Core/Src/main.c ****         last_btn = btn;
 194              		.loc 1 81 9 view .LVU47
  82:Core/Src/main.c ****         delay(10000);
 195              		.loc 1 82 9 view .LVU48
 196 0076 42F21070 		movw	r0, #10000
 197 007a FFF7FEFF 		bl	delay
 198              	.LVL12:
 199              	.LBE4:
  60:Core/Src/main.c ****         // Чтение PC13 вместо PA2
 200              		.loc 1 60 10 view .LVU49
ARM GAS  C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s 			page 6


 201              	.LBB5:
  81:Core/Src/main.c ****         delay(10000);
 202              		.loc 1 81 18 is_stmt 0 view .LVU50
 203 007e 2A46     		mov	r2, r5
 204              	.LVL13:
 205              	.L16:
  81:Core/Src/main.c ****         delay(10000);
 206              		.loc 1 81 18 view .LVU51
 207              	.LBE5:
  60:Core/Src/main.c ****         // Чтение PC13 вместо PA2
 208              		.loc 1 60 5 is_stmt 1 view .LVU52
 209              	.LBB6:
  62:Core/Src/main.c ****         
 210              		.loc 1 62 9 view .LVU53
  62:Core/Src/main.c ****         
 211              		.loc 1 62 30 is_stmt 0 view .LVU54
 212 0080 174B     		ldr	r3, .L19+24
 213 0082 9B68     		ldr	r3, [r3, #8]
  62:Core/Src/main.c ****         
 214              		.loc 1 62 36 view .LVU55
 215 0084 03F40053 		and	r3, r3, #8192
  62:Core/Src/main.c ****         
 216              		.loc 1 62 23 view .LVU56
 217 0088 002B     		cmp	r3, #0
 218 008a 0CBF     		ite	eq
 219 008c 0125     		moveq	r5, #1
 220 008e 0025     		movne	r5, #0
 221              	.LVL14:
  64:Core/Src/main.c ****             current_step++;
 222              		.loc 1 64 9 is_stmt 1 view .LVU57
  64:Core/Src/main.c ****             current_step++;
 223              		.loc 1 64 12 is_stmt 0 view .LVU58
 224 0090 F1D1     		bne	.L8
  64:Core/Src/main.c ****             current_step++;
 225              		.loc 1 64 17 discriminator 1 view .LVU59
 226 0092 002A     		cmp	r2, #0
 227 0094 EFD1     		bne	.L8
  65:Core/Src/main.c ****             if (current_step > 4) current_step = 0;
 228              		.loc 1 65 13 is_stmt 1 view .LVU60
  65:Core/Src/main.c ****             if (current_step > 4) current_step = 0;
 229              		.loc 1 65 25 is_stmt 0 view .LVU61
 230 0096 0134     		adds	r4, r4, #1
 231              	.LVL15:
  65:Core/Src/main.c ****             if (current_step > 4) current_step = 0;
 232              		.loc 1 65 25 view .LVU62
 233 0098 E4B2     		uxtb	r4, r4
 234              	.LVL16:
  66:Core/Src/main.c ****             
 235              		.loc 1 66 13 is_stmt 1 view .LVU63
  66:Core/Src/main.c ****             
 236              		.loc 1 66 16 is_stmt 0 view .LVU64
 237 009a 042C     		cmp	r4, #4
 238 009c DAD9     		bls	.L9
  66:Core/Src/main.c ****             
 239              		.loc 1 66 35 is_stmt 1 discriminator 1 view .LVU65
 240              	.LVL17:
  68:Core/Src/main.c ****             
ARM GAS  C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s 			page 7


 241              		.loc 1 68 13 view .LVU66
  68:Core/Src/main.c ****             
 242              		.loc 1 68 25 is_stmt 0 view .LVU67
 243 009e 03F18043 		add	r3, r3, #1073741824
 244 00a2 03F58433 		add	r3, r3, #67584
 245 00a6 4FF47001 		mov	r1, #15728640
 246 00aa 1961     		str	r1, [r3, #16]
  70:Core/Src/main.c ****                 case 1: GPIOA->BSRR = (1 << 4); break;
 247              		.loc 1 70 13 is_stmt 1 view .LVU68
  66:Core/Src/main.c ****             
 248              		.loc 1 66 48 is_stmt 0 discriminator 1 view .LVU69
 249 00ac 1446     		mov	r4, r2
 250 00ae DFE7     		b	.L10
 251              	.LVL18:
 252              	.L14:
  72:Core/Src/main.c ****                 case 3: GPIOA->BSRR = (1 << 4) | (1 << 5) | (1 << 6); break;
 253              		.loc 1 72 25 is_stmt 1 view .LVU70
  72:Core/Src/main.c ****                 case 3: GPIOA->BSRR = (1 << 4) | (1 << 5) | (1 << 6); break;
 254              		.loc 1 72 37 is_stmt 0 view .LVU71
 255 00b0 064B     		ldr	r3, .L19+4
 256 00b2 3022     		movs	r2, #48
 257 00b4 1A61     		str	r2, [r3, #16]
  72:Core/Src/main.c ****                 case 3: GPIOA->BSRR = (1 << 4) | (1 << 5) | (1 << 6); break;
 258              		.loc 1 72 60 is_stmt 1 view .LVU72
 259 00b6 DBE7     		b	.L10
 260              	.L13:
  73:Core/Src/main.c ****                 case 4: GPIOA->BSRR = (1 << 4) | (1 << 5) | (1 << 6) | (1 << 7); break;
 261              		.loc 1 73 25 view .LVU73
  73:Core/Src/main.c ****                 case 4: GPIOA->BSRR = (1 << 4) | (1 << 5) | (1 << 6) | (1 << 7); break;
 262              		.loc 1 73 37 is_stmt 0 view .LVU74
 263 00b8 044B     		ldr	r3, .L19+4
 264 00ba 7022     		movs	r2, #112
 265 00bc 1A61     		str	r2, [r3, #16]
  73:Core/Src/main.c ****                 case 4: GPIOA->BSRR = (1 << 4) | (1 << 5) | (1 << 6) | (1 << 7); break;
 266              		.loc 1 73 71 is_stmt 1 view .LVU75
 267 00be D7E7     		b	.L10
 268              	.L11:
  74:Core/Src/main.c ****                 case 0: break;
 269              		.loc 1 74 25 view .LVU76
  74:Core/Src/main.c ****                 case 0: break;
 270              		.loc 1 74 37 is_stmt 0 view .LVU77
 271 00c0 024B     		ldr	r3, .L19+4
 272 00c2 F022     		movs	r2, #240
 273 00c4 1A61     		str	r2, [r3, #16]
  74:Core/Src/main.c ****                 case 0: break;
 274              		.loc 1 74 82 is_stmt 1 view .LVU78
 275 00c6 D3E7     		b	.L10
 276              	.L20:
 277              		.align	2
 278              	.L19:
 279 00c8 00100240 		.word	1073876992
 280 00cc 00080140 		.word	1073809408
 281 00d0 00001111 		.word	286326784
 282 00d4 44443444 		.word	1144276036
 283 00d8 20A10700 		.word	500000
 284 00dc A0860100 		.word	100000
 285 00e0 00100140 		.word	1073811456
ARM GAS  C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s 			page 8


 286              	.LBE6:
 287              		.cfi_endproc
 288              	.LFE1:
 290              		.text
 291              	.Letext0:
 292              		.file 2 "D:/Programs/Education/STM32/Tools/Xpack/arm-none-eabi/include/machine/_default_types.h"
 293              		.file 3 "D:/Programs/Education/STM32/Tools/Xpack/arm-none-eabi/include/sys/_stdint.h"
ARM GAS  C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s 			page 9


DEFINED SYMBOLS
                            *ABS*:00000000 main.c
C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s:19     .text.delay:00000000 $t
C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s:25     .text.delay:00000000 delay
C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s:66     .text.main:00000000 $t
C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s:72     .text.main:00000000 main
C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s:175    .text.main:00000066 $d
C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s:179    .text.main:0000006a $t
C:\Users\Dmitriy\AppData\Local\Temp\cckjho3G.s:279    .text.main:000000c8 $d

NO UNDEFINED SYMBOLS
